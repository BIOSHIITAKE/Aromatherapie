<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Formulation Clinique d'Huiles Essentielles - Master</title>
<style>
body { font-family: Arial, sans-serif; background:#f7f7f7; margin:0; padding:0;}
header { background:#4a7c59; color:white; padding:15px 20px; text-align:center; }
h1 { margin:0; font-size:26px; }
.container { padding:20px; max-width:1400px; margin:auto; }
.selectors, .mix, .synergy { margin-bottom:30px; }
label { display:block; margin-top:10px; font-weight:bold; }
input, select { padding:6px; width:300px; margin-top:5px; }
table { border-collapse: collapse; width:100%; background:white; margin-top:10px;}
table, th, td { border:1px solid #ccc;}
th, td { padding:8px; text-align:left;}
th { background:#eee; }
button { padding:8px 15px; margin-top:10px; cursor:pointer; background:#4a7c59; color:white; border:none; border-radius:5px; }
button:hover { background:#3e6c4d; }
.alert { color:red; font-weight:bold; margin-top:5px; }
.info-box { background:#fff3cd; padding:12px; border:1px solid #ffeeba; margin-top:10px; border-radius:5px; }
</style>
</head>
<body>
<header>
<h1>Formulation Clinique d'Huiles Essentielles - Master</h1>
<p>Application scientifique hyper-fonctionnelle pour aromathérapie avancée</p>
</header>

<div class="container">

<!-- Sélecteurs -->
<div class="selectors">
<h2>Recherche et ajout d'HE</h2>

<label for="heSelect">Choisir une HE :</label>
<select id="heSelect">
<option value="">--Choisir--</option>
</select>

<label for="searchMolecule">Recherche par molécule :</label>
<input type="text" id="searchMolecule" placeholder="Ex: linalol, limonene, menthol">

<label for="filterVoie">Filtrer par voie :</label>
<select id="filterVoie">
<option value="">--Toutes--</option>
<option>Voie cutanée</option>
<option>Voie olfactive</option>
<option>Diffusion</option>
<option>Voie orale diluée</option>
</select>

<label for="filterUser">Filtrer par utilisateur :</label>
<select id="filterUser">
<option value="">--Tous--</option>
<option value="grossesse">Grossesse</option>
<option value="ageMin">Age minimum</option>
</select>

<button id="addHE">Ajouter au mélange</button>
</div>

<!-- Mélange sélectionné -->
<div class="mix">
<h2>Mélange Sélectionné</h2>
<table id="mixTable">
<thead>
<tr>
<th>HE</th>
<th>Molécules principales</th>
<th>Propriétés</th>
<th>Indications</th>
<th>Voie d'utilisation</th>
<th>% dans mélange</th>
<th>Supprimer</th>
</tr>
</thead>
<tbody></tbody>
</table>
<div id="alerts"></div>
<p id="synergySummary"></p>
</div>

<!-- Calculateur de synergie -->
<div class="synergy">
<h2>Calculateur de Synergie & Conseils Galéniques</h2>
<ul id="synergyList"></ul>
<div id="galenique" class="info-box"></div>
</div>

</div>

<script>
// Base de données des HE
const HUILLES = [
{ nom:"Lavande vraie", latin:"Lavandula angustifolia", famille:"Lamiaceae",
  molecules:["Linalol","Acétate de linalyle"], propriétés:["Calmante","Antispasmodique","Régénératrice cutanée"],
  indications:["Stress","Troubles du sommeil"], voies:["Voie cutanée","Voie olfactive"], restrictions:{grossesse:true, ageMin:7} },

{ nom:"Tea tree", latin:"Melaleuca alternifolia", famille:"Myrtaceae",
  molecules:["Terpinène-4-ol","γ-Terpinène"], propriétés:["Antibactérienne","Antifongique","Immunostimulante"],
  indications:["Infections cutanées","Acné"], voies:["Voie cutanée","Diffusion"], restrictions:{grossesse:true, ageMin:7} },

{ nom:"Menthe poivrée", latin:"Mentha × piperita", famille:"Lamiaceae",
  molecules:["Menthol","Menthone"], propriétés:["Tonique","Digestive","Antalgique locale"],
  indications:["Maux de tête","Troubles digestifs"], voies:["Voie cutanée","Voie orale diluée"], restrictions:{grossesse:true, ageMin:7} },

{ nom:"Citron", latin:"Citrus limon", famille:"Rutaceae",
  molecules:["Limonène","β-pinène"], propriétés:["Tonique","Dépurative","Antiseptique aérienne"],
  indications:["Fatigue","Digestif"], voies:["Diffusion","Voie cutanée"], restrictions:{grossesse:true, ageMin:7} },

{ nom:"Ylang-ylang complète", latin:"Cananga odorata", famille:"Annonaceae",
  molecules:["Germacrène D","Benzoate de benzyle"], propriétés:["Relaxante","Hypotensive","Aphrodisiaque"],
  indications:["Stress","Hypertension"], voies:["Voie cutanée","Diffusion"], restrictions:{grossesse:true, ageMin:7} },

{ nom:"Genévrier commun", latin:"Juniperus communis", famille:"Cupressacées",
  molecules:["α-pinène","sabinène","myrcène","germacrène","β-caryophyllène","terpinène-4-ol"],
  propriétés:["Anti-inflammatoire","Cholagogue","Anti-infectieuse"],
  indications:["Stimulation hépatique","Infections"], voies:["Voie cutanée","Diffusion"], restrictions:{grossesse:true, ageMin:7} }
];

let mix = [];

// Init select
const heSelect = document.getElementById('heSelect');
HUILLES.forEach((he,i)=>{ let opt = document.createElement('option'); opt.value=i; opt.textContent=he.nom; heSelect.appendChild(opt); });

// Normalisation accents
function normalize(str){ return str.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(); }

// Ajouter HE
document.getElementById('addHE').addEventListener('click',()=>{
  const idx = heSelect.value;
  if(idx==="") return alert("Veuillez choisir une HE.");
  const he = HUILLES[idx];
  if(mix.includes(he)) return alert("HE déjà dans le mélange !");
  mix.push(he); updateMixTable(); updateSynergy();
});

// Recherche molécule
document.getElementById('searchMolecule').addEventListener('input',(e)=>{
  const val = normalize(e.target.value);
  heSelect.innerHTML='<option value="">--Choisir--</option>';
  HUILLES.forEach((he,i)=>{ if(he.molecules.some(m=>normalize(m).includes(val))){ let opt=document.createElement('option'); opt.value=i; opt.textContent=he.nom; heSelect.appendChild(opt); } });
});

// Table mélange
function updateMixTable(){
  const tbody = document.querySelector('#mixTable tbody'); tbody.innerHTML="";
  mix.forEach((he,i)=>{
    const tr = document.createElement('tr');
    tr.innerHTML=`<td>${he.nom}</td>
                  <td>${he.molecules.join(", ")}</td>
                  <td>${he.propriétés.join(", ")}</td>
                  <td>${he.indications.join(", ")}</td>
                  <td>${he.voies.join(", ")}</td>
                  <td>${(100/mix.length).toFixed(1)}%</td>
                  <td><button onclick="removeHE(${i})">Supprimer</button></td>`;
    tbody.appendChild(tr);
  });
}

function removeHE(i){ mix.splice(i,1); updateMixTable(); updateSynergy(); }

// Calcul synergie
function updateSynergy(){
  const ul = document.getElementById('synergyList'); ul.innerHTML="";
  const alertsDiv = document.getElementById('alerts'); alertsDiv.innerHTML="";
  const gal = document.getElementById('galenique'); gal.innerHTML="";

  let props = new Set(), voies = new Set(), warnings = [];

  mix.forEach(he=>{
    he.propriétés.forEach(p=>props.add(p));
    he.voies.forEach(v=>voies.add(v));
    if(he.restrictions.grossesse) warnings.push(`${he.nom} : éviter pendant grossesse`);
    if(he.restrictions.ageMin) warnings.push(`${he.nom} : âge minimum ${he.restrictions.ageMin} ans`);
  });

  // Exemples interactions simples
  if(voies.has("Voie orale diluée") && voies.has("Diffusion")) warnings.push("Attention : certaines HE orales ne doivent pas être diffusées simultanément !");

  if(warnings.length){ alertsDiv.innerHTML=warnings.map(w=>`<div class="alert">${w}</div>`).join(""); }

  props.forEach(p=>{ const li=document.createElement('li'); li.textContent=p; ul.appendChild(li); });

  if(mix.length>0){
    gal.innerHTML=`<strong>Conseils galéniques :</strong><br>
    Pour ${mix.length} HE : utiliser des bases adaptées selon la voie (huile végétale pour cutanée, micro-émulsions pour orale, diffuseur pour olfactive).<br>
    Respecter doses maximales, restrictions et compatibilités des voies.`;
  }

  document.getElementById('synergySummary').textContent=`Propriétés cumulées: ${Array.from(props).join(", ")} | Voies utilisées: ${Array.from(voies).join(", ")}`;
}
</script>
</body>
</html>


