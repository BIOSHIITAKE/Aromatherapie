<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Formulation Clinique d'Huiles Essentielles</title>
<style>
body { font-family: Arial, sans-serif; background: #f8f8f8; margin:0; padding:0;}
header { background:#4a7c59; color:white; padding:10px 20px; text-align:center; }
h1 { margin:0; font-size:24px; }
.container { padding:20px; max-width:1200px; margin:auto; }
.selectors, .mix, .synergy { margin-bottom:30px; }
label { display:block; margin-top:10px; }
input, select { padding:5px; width:250px; }
table { border-collapse: collapse; width:100%; background:white; margin-top:10px;}
table, th, td { border:1px solid #ccc;}
th, td { padding:8px; text-align:left;}
th { background:#eee; }
button { padding:8px 15px; margin-top:10px; cursor:pointer; background:#4a7c59; color:white; border:none; }
button:hover { background:#3e6c4d; }
.mixed-he { margin-top:10px; }
.alert { color:red; font-weight:bold; }
</style>
</head>
<body>
<header>
<h1>Formulation Clinique d'Huiles Essentielles</h1>
<p>Recherche par molécule, nom, propriétés, voies et calcul de synergie</p>
</header>

<div class="container">

<div class="selectors">
<h2>Choix des Huiles Essentielles</h2>
<label for="heSelect">Sélectionner une HE :</label>
<select id="heSelect">
<option value="">--Choisir--</option>
</select>

<label for="searchMolecule">Recherche par molécule :</label>
<input type="text" id="searchMolecule" placeholder="Ex: linalol, limonene, menthol">

<button id="addHE">Ajouter au mélange</button>
</div>

<div class="mix">
<h2>Mélange Sélectionné</h2>
<table id="mixTable">
<thead>
<tr>
<th>HE</th>
<th>Molécules principales</th>
<th>Propriétés</th>
<th>Indications</th>
<th>Voie d'utilisation</th>
<th>% dans mélange</th>
<th>Supprimer</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<p id="synergySummary"></p>
</div>

<div class="synergy">
<h2>Calculateur de Synergie</h2>
<p>Synthèse des propriétés cumulées et alertes :</p>
<ul id="synergyList"></ul>
</div>

</div>

<script>
// Liste des HE avec leurs données
const HUILLES = [
  {
    nom: "Lavande vraie",
    latin: "Lavandula angustifolia",
    famille: "Lamiaceae",
    molecules: ["Linalol", "Acétate de linalyle"],
    propriétés: ["Calmante", "Antispasmodique", "Régénératrice cutanée"],
    indications: ["Stress", "Troubles du sommeil"],
    voies: ["Voie cutanée", "Voie olfactive"]
  },
  {
    nom: "Tea tree",
    latin: "Melaleuca alternifolia",
    famille: "Myrtaceae",
    molecules: ["Terpinène-4-ol", "γ-Terpinène"],
    propriétés: ["Antibactérienne", "Antifongique", "Immunostimulante"],
    indications: ["Infections cutanées", "Acné"],
    voies: ["Voie cutanée", "Diffusion"]
  },
  {
    nom: "Menthe poivrée",
    latin: "Mentha × piperita",
    famille: "Lamiaceae",
    molecules: ["Menthol", "Menthone"],
    propriétés: ["Tonique", "Digestive", "Antalgique locale"],
    indications: ["Maux de tête", "Troubles digestifs"],
    voies: ["Voie cutanée", "Voie orale diluée"]
  },
  {
    nom: "Citron",
    latin: "Citrus limon",
    famille: "Rutaceae",
    molecules: ["Limonène", "β-pinène"],
    propriétés: ["Tonique", "Dépurative", "Antiseptique aérienne"],
    indications: ["Fatigue", "Digestif"],
    voies: ["Diffusion", "Voie cutanée"]
  },
  {
    nom: "Ylang-ylang complète",
    latin: "Cananga odorata",
    famille: "Annonaceae",
    molecules: ["Germacrène D", "Benzoate de benzyle"],
    propriétés: ["Relaxante", "Hypotensive", "Aphrodisiaque"],
    indications: ["Stress", "Hypertension"],
    voies: ["Voie cutanée", "Diffusion"]
  },
  {
    nom: "Genévrier commun",
    latin: "Juniperus communis",
    famille: "Cupressacées",
    molecules: ["α-pinène", "sabinène", "myrcène", "germacrène", "β-caryophyllène", "terpinène-4-ol"],
    propriétés: ["Anti-inflammatoire","Cholagogue","Anti-infectieuse"],
    indications: ["Stimulation hépatique","Infections"],
    voies: ["Voie cutanée", "Diffusion"]
  }
];

let mix = [];

// Initialiser le select
const heSelect = document.getElementById('heSelect');
HUILLES.forEach((he, i)=>{
  let opt = document.createElement('option');
  opt.value = i;
  opt.textContent = he.nom;
  heSelect.appendChild(opt);
});

// Fonction pour normaliser les chaînes (sans accents, minuscule)
function normalize(str){
  return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
}

// Ajouter HE au mélange
document.getElementById('addHE').addEventListener('click',()=>{
  const index = heSelect.value;
  if(index === "") return alert("Veuillez choisir une HE.");
  const he = HUILLES[index];
  if(mix.includes(he)) return alert("HE déjà dans le mélange !");
  mix.push(he);
  updateMixTable();
  updateSynergy();
});

// Recherche molécule sans accent obligatoire
document.getElementById('searchMolecule').addEventListener('input',(e)=>{
  const val = normalize(e.target.value);
  heSelect.innerHTML = '<option value="">--Choisir--</option>';
  HUILLES.forEach((he,i)=>{
    if(he.molecules.some(m => normalize(m).includes(val))){
      let opt = document.createElement('option');
      opt.value = i;
      opt.textContent = he.nom;
      heSelect.appendChild(opt);
    }
  });
});

function updateMixTable(){
  const tbody = document.querySelector('#mixTable tbody');
  tbody.innerHTML = "";
  mix.forEach((he,i)=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${he.nom}</td>
                    <td>${he.molecules.join(", ")}</td>
                    <td>${he.propriétés.join(", ")}</td>
                    <td>${he.indications.join(", ")}</td>
                    <td>${he.voies.join(", ")}</td>
                    <td>${(100/mix.length).toFixed(1)}%</td>
                    <td><button onclick="removeHE(${i})">Supprimer</button></td>`;
    tbody.appendChild(tr);
  });
}

function removeHE(index){
  mix.splice(index,1);
  updateMixTable();
  updateSynergy();
}

function updateSynergy(){
  const ul = document.getElementById('synergyList');
  ul.innerHTML = "";
  let props = new Set();
  let voies = new Set();
  mix.forEach(he=>{
    he.propriétés.forEach(p=>props.add(p));
    he.voies.forEach(v=>voies.add(v));
  });
  props.forEach(p=>{
    const li = document.createElement('li');
    li.textContent = p;
    ul.appendChild(li);
  });
  document.getElementById('synergySummary').textContent = `Propriétés cumulées: ${Array.from(props).join(", ")} | Voies utilisées: ${Array.from(voies).join(", ")}`;
}
</script>

</body>
</html>

